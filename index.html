<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.png?v=5.1.1" />






<meta name="description" content="Every man is his own worst enemy.">
<meta property="og:type" content="website">
<meta property="og:title" content="Nothing lasts forever.">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Nothing lasts forever.">
<meta property="og:description" content="Every man is his own worst enemy.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Nothing lasts forever.">
<meta name="twitter:description" content="Every man is his own worst enemy.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Nothing lasts forever.</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Nothing lasts forever.</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/29/DistributedLock/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="harry,qiyazhong@163.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/lufei1.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nothing lasts forever.">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/29/DistributedLock/" itemprop="url">分布式锁(DistributedLock)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-29T08:18:53+08:00">
                2017-06-29
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/distributed/" itemprop="url" rel="index">
                    <span itemprop="name">Distributed</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="/images/distributed/distributedlock.png" alt="Monoliths"></p>
<h4 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h4><blockquote>
<p>为分布式应用各节点对共享资源的排他式访问而设定的锁就是分布式锁。在分布式场景下，有很多种情况都需要实现多节点的最终一致性。比如全局发号器，分布式事务等等。</p>
</blockquote>
<h4 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h4><p>分布式锁，是控制分布式系统之间同步访问共享资源的一种方式。在分布式系统中，常常需要协调他们的动作。如果不同的系统或是同一个系统的不同主机之间共享了一个或一组资源，那么访问这些资源的时候，往往需要互斥来防止彼此干扰来保证一致性，在这种情况下，便需要使用到分布式锁。</p>
<h5 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h5><p>传统实现分布式锁的方案一般是利用持久化数据库（如利用InnoDB行锁，或事务，或version乐观锁），当然大部分时候可以满足大部分人的需求。而如今互联网应用的量级已经几何级别的爆发，利用诸如zookeeper，redis等更高效的分布式组件来实现分布式锁，可以提供高可用的更强壮的锁特性，并且支持丰富化的使用场景。</p>
<h4 id="一般方案"><a href="#一般方案" class="headerlink" title="一般方案"></a>一般方案</h4><ul>
<li>dataBase<br>  1 事务<br>  2 利用InnoDB行锁<br>  3 table column 的version字段</li>
<li>redis<br>  1 redis的watch 机制<br>  2 lua脚本实现</li>
<li>zookeeper<br>  1 aaa<br>  2 山沟沟</li>
<li>redislock</li>
<li>redission</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/28/Microservices/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="harry,qiyazhong@163.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/lufei1.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nothing lasts forever.">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/28/Microservices/" itemprop="url">微服务 (Microservices)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-28T10:52:12+08:00">
                2017-06-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/microservices/" itemprop="url" rel="index">
                    <span itemprop="name">Microservices</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="/images/microservices/microservices.png" alt="microservices"></p>
<h4 id="为什么需要微服务架构"><a href="#为什么需要微服务架构" class="headerlink" title="为什么需要微服务架构"></a>为什么需要微服务架构</h4><ul>
<li>使用传统的整体式架构(Monolithic Architecture)应用开发系统，如CRM、ERP等大型应用，随着新需求的不断增加，企业更新和修复大型整体式应用变得越来越困难</li>
<li>随着移动互联网的发展，企业被迫将其应用迁移至现代化UI界面架构以便能兼容移动设备，这要求企业能实现应用功能的快速上线</li>
<li>许多企业在SOA投资中得到的回报有限，SOA可以通过标准化服务接口实现能力的重用，但对于快速变化的需求，受到整体式应用的限制，有时候显得力不从心</li>
<li>随着应用云化的日益普及，生于云端的应用具有与传统IT不同的技术基因和开发运维模式</li>
</ul>
<hr>
<p><img src="/images/microservices/Microservices-in-Insurance.jpg" alt="microservices-Insurance"></p>
<h4 id="云计算及互联网公司大量开源轻量级技术涌现并日渐成熟"><a href="#云计算及互联网公司大量开源轻量级技术涌现并日渐成熟" class="headerlink" title="云计算及互联网公司大量开源轻量级技术涌现并日渐成熟"></a>云计算及互联网公司大量开源轻量级技术涌现并日渐成熟</h4><ul>
<li>互联网/内联网/网络更加成熟；</li>
<li>轻量级运行时技术的出现(node.js, WAS Liberty等)；</li>
<li>新的方法与工具(Agile, DevOps, TDD, CI, XP, Puppet, Chef…)；</li>
<li>新的轻量级协议(RESTful API接口, 轻量级消息机制)；</li>
<li>简化的基础设施：操作系统虚拟化(hypervisors), 容器化(e.g. Docker), 基础设施即服务 (IaaS), 工作负载虚拟化(Kubernetes,Spark…)等；</li>
<li>服务平台化(PaaS)： 云服务平台上具有自动缩放、工作负载管理、SLA 管理、消息机制、缓存、构建管理等各种按需使用的服务；</li>
<li>新的可替代数据持久化模型：如NoSQL, MapReduce, BASE, CQRS等；</li>
<li>标准化代码管理：如Github等。<blockquote>
<p><b> 这一切都催生了新的架构设计风格 – 微服务架构的出现。</b></p>
</blockquote>
</li>
</ul>
<hr>
<p><img src="/images/microservices/ss-microservices.png" alt="ss-microservices"></p>
<h4 id="微服务定义"><a href="#微服务定义" class="headerlink" title="微服务定义"></a>微服务定义</h4><p><strong><em>(Microservices) 是一种软件架构风格，它是以专注于单一责任与功能的小型功能区块 (Small Building Blocks) 为基础，利用模组化的方式组合出复杂的大型应用程序，各功能区块使用与语言无关 (Language-Independent/Language agnostic) 的 API 集相互通讯。微服务是一种以业务功能为主的服务设计概念，每一个服务都具有自主运行的业务功能，对外开放不受语言限制的 API (最常用的是 HTTP)，应用程序则是由一个或多个微服务组成。</em></strong></p>
<hr>
<p><img src="/images/microservices/decentralised-data.png" alt="dataBase"></p>
<h4 id="微服务理念中有数个数据库的规划方式"><a href="#微服务理念中有数个数据库的规划方式" class="headerlink" title="微服务理念中有数个数据库的规划方式"></a>微服务理念中有数个数据库的规划方式</h4><ul>
<li>微服务理念中有数个数据库的规划方式。</li>
<li>每个服务都各有一个数据库，同属性的服务可共享同个数据库。</li>
<li>所有服务都共享同个数据库，但是不同表格，并且不会跨域存取。</li>
<li>每个服务都有自己的数据库，就算是同属性的服务也是，数据库并不会共享。</li>
</ul>
<hr>
<p><img src="/images/microservices/ms-article.png" alt="James Lewis,Martin Fowler"></p>
<h4 id="历史"><a href="#历史" class="headerlink" title="历史"></a>历史</h4><p>2014年，Martin Fowler 与 James Lewis 共同提出了微服务的概念，定义了微服务是由以单一应用程序构成的小服务，自己拥有自己的行程与轻量化处理，服务依业务功能设计，以全自动的方式部署，与其他服务使用 HTTP API 通讯。同时服务会使用最小的规模的集中管理 (例如 Docker) 能力，服务可以用不同的编程语言与数据库等元件实作。</p>
<hr>
<h4 id="特征"><a href="#特征" class="headerlink" title="特征"></a>特征</h4><h5 id="（1）围绕业务功能进行组织-Organized-around-Business-Capabilities"><a href="#（1）围绕业务功能进行组织-Organized-around-Business-Capabilities" class="headerlink" title="（1）围绕业务功能进行组织 Organized around Business Capabilities"></a>（1）围绕业务功能进行组织 Organized around Business Capabilities</h5><ul>
<li>不再是以前的纵向切分, 而改为按业务功能横向划分, 一个微服务最好由一个小团队针对一个业务单元来构建<h5 id="（2）做产品而非做项目-Products-not-Projects"><a href="#（2）做产品而非做项目-Products-not-Projects" class="headerlink" title="（2）做产品而非做项目 Products not Projects"></a>（2）做产品而非做项目 Products not Projects</h5></li>
<li>不再是做一个个项目, 交付后就完事了, 而是做产品, 从设计编码到产品运维全过程掌控和负责 you build it, you run it<h5 id="（3）智能终端加简单通道-Smart-endpoints-and-dumb-pipes"><a href="#（3）智能终端加简单通道-Smart-endpoints-and-dumb-pipes" class="headerlink" title="（3）智能终端加简单通道 Smart endpoints and dumb pipes"></a>（3）智能终端加简单通道 Smart endpoints and dumb pipes</h5></li>
<li>基于resource的API,大量逻辑放在客户端, 服务器端着重于提供资源 Be of the web, not behind the web<h5 id="（4）去中心化管理-Decentralized-Governance"><a href="#（4）去中心化管理-Decentralized-Governance" class="headerlink" title="（4）去中心化管理 Decentralized Governance"></a>（4）去中心化管理 Decentralized Governance</h5></li>
<li>自行其是, 自我管理, 不必在局限在一个系统里, 围绕着一个中心<h5 id="（5）去中心化数据管理-Decentralized-Data-Management"><a href="#（5）去中心化数据管理-Decentralized-Data-Management" class="headerlink" title="（5）去中心化数据管理 Decentralized Data Management"></a>（5）去中心化数据管理 Decentralized Data Management</h5></li>
<li>各人自扫门前雪, 自己管理和维护自己的数据, 各自之间互不直接访问彼此的数据, 只通过 API 来存取数据<h5 id="（6）基础设施自动化-Infrastructure-Automation"><a href="#（6）基础设施自动化-Infrastructure-Automation" class="headerlink" title="（6）基础设施自动化 Infrastructure Automation"></a>（6）基础设施自动化 Infrastructure Automation</h5></li>
<li>每个微服务应该关注于自己的业务功能实现, 基础设施应该尽量自动化, 构建自动化,测试自动化, 部署自动化, 监控自动化<h5 id="（7）为应对失败而设计-Design-for-failure"><a href="#（7）为应对失败而设计-Design-for-failure" class="headerlink" title="（7）为应对失败而设计 Design for failure"></a>（7）为应对失败而设计 Design for failure</h5></li>
<li>设计之初就要考虑高可靠性High Availablity 和灾难恢复 Disaster Recover, 并考虑在错误监测和错误诊断方面如何着手<h5 id="（8）演进式设计-Evolutionary-Design"><a href="#（8）演进式设计-Evolutionary-Design" class="headerlink" title="（8）演进式设计 Evolutionary Design"></a>（8）演进式设计 Evolutionary Design</h5></li>
<li>没有完美的架构, 唯一不变的是变化, 要善于应对变化,容易改变其设计和实现, 因为其小,故而易变</li>
</ul>
<hr>
<h4 id="好处"><a href="#好处" class="headerlink" title="好处"></a>好处</h4><ul>
<li>独立进程运行，每个服务都容易被取代</li>
<li>轻量级的通信框架</li>
<li>独立的部署</li>
<li>由于功能被拆成多个服务，因此可以由不同的编程语言、数据库实作</li>
<li>架构是对称而非分层（即生产者与消费者的关系）</li>
</ul>
<hr>
<p><img src="/images/microservices/sketch.png" alt="Monoliths and Microservices"></p>
<h4 id="单体-Monolithic-和微服务-Microservices-架构的比较"><a href="#单体-Monolithic-和微服务-Microservices-架构的比较" class="headerlink" title="单体(Monolithic)和微服务(Microservices)架构的比较"></a>单体(Monolithic)和微服务(Microservices)架构的比较</h4><p>微服务架构强调的第一个重点就是业务系统需要彻底的组件化和服务化，原有的单个业务系统会拆分为多个可以独立开发，设计，运行和运维的小应用。这些小应用之间通过服务完成交互和集成。每个小应用从前端web ui，到控制层，逻辑层，数据库访问，数据库都完全是独立的一套。</p>
<h5 id="Monolithic"><a href="#Monolithic" class="headerlink" title="Monolithic"></a>Monolithic</h5><p><img src="/images/microservices/Monolithic.png" alt="Monoliths"><br>  <strong>优点</strong></p>
<ul>
<li>核心是业务逻辑，由定义服务、域对象和事件的模块完成。围绕着核心的是与外界打交道的适配器。适配器包括数据库访问组件、生产和处理消息的消息组件，以及提供API或者UI访问支持的web模块等。</li>
<li>这种应用开发风格很常见，因为IDE和其它工具都擅长开发一个简单应用，这类应用也很易于调试，只需要简单运行此应用，用Selenium链接UI就可以完成端到端测试。单体式应用也易于部署，只需要把打包应用拷贝到服务器端，通过在负载均衡器后端运行多个拷贝就可以轻松实现应用扩展。在早期这类应用运行的很好。<br><strong>缺点</strong></li>
<li>一个简单的应用会随着时间推移逐渐变大。在每次的sprint中，开发团队都会面对新“故事”，然后开发许多新代码。几年后，这个小而简单的应用会变成了一个巨大的怪物。</li>
<li>一旦你的应用变成一个又大又复杂的怪物，那开发团队肯定很痛苦。敏捷开发和部署举步维艰，其中最主要问题就是这个应用太复杂，以至于任何单个开发者都不可能搞懂它。因此，修正bug和正确的添加新功能变的非常困难，并且很耗时。</li>
<li>单体式应用也会降低开发速度。应用越大，启动时间会越长。</li>
<li>单体式应用在不同模块发生资源冲突时，扩展将会非常困难。</li>
<li>单体式应用另外一个问题是可靠性。</li>
<li>单体式应用使得采用新架构和语言非常困难。比如，设想你有两百万行采用XYZ框架写的代码。如果想改成ABC框架，无论是时间还是成本都是非常昂贵的，即使ABC框架更好。因此，这是一个无法逾越的鸿沟。<h5 id="Microservices"><a href="#Microservices" class="headerlink" title="Microservices"></a>Microservices</h5><img src="/images/microservices/micro.png" alt="Microservices"><h6 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h6></li>
<li>每个服务都比较简单，只关注于一个业务功能。</li>
<li>微服务架构方式是松耦合的，可以提供更高的灵活性。</li>
<li>微服务可通过最佳及最合适的不同的编程语言与工具进行开发，能够做到有的放矢地解决针对性问题。</li>
<li>每个微服务可由不同团队独立开发，互不影响，加快推出市场的速度。</li>
<li>微服务架构是持续交付(CD)的巨大推动力，允许在频繁发布不同服务的同时保持系统其他部分的可用性和稳定性。</li>
<li>可用性高</li>
<li>独立按需扩展</li>
</ul>
<h6 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h6><ul>
<li>运维开销及成本增加</li>
<li>必须有坚实的DevOps开发运维一体化技能</li>
<li>隐式接口及接口匹配问题</li>
<li>代码重复</li>
<li>分布式系统的复杂性</li>
<li>异步机制</li>
<li>可测性的挑战<h5 id="关于微服务架构的取舍"><a href="#关于微服务架构的取舍" class="headerlink" title="关于微服务架构的取舍"></a>关于微服务架构的取舍</h5></li>
<li>在合适的项目，合适的团队，采用微服务架构收益会大于成本。</li>
<li>微服务架构有很多吸引人的地方，但在拥抱微服务之前，也需要认清它所带来的挑战。</li>
<li>需要避免为了“微服务”而“微服务”。</li>
<li>微服务架构引入策略 – 对传统企业而言，开始时可以考虑引入部分合适的微服务架构原则对已有系统进行改造或新建微服务应用，逐步探索及积累微服务架构经验，而非全盘实施微服务架构。</li>
<li>服务间通信成本</li>
<li>数据一致性</li>
<li>性能监控</li>
</ul>
<hr>
<p><img src="/images/microservices/Microservices-vs-SOA.jpg" alt="Micro_vs_Soa"></p>
<h4 id="SOA和微服务架构的区别"><a href="#SOA和微服务架构的区别" class="headerlink" title="SOA和微服务架构的区别"></a>SOA和微服务架构的区别</h4><p>微服务架构强调的第一个重点就是业务系统需要彻底的组件化和服务化，原有的单个业务系统会拆分为多个可以独立开发，设计，运行和运维的小应用。这些小应用之间通过服务完成交互和集成。每个小应用从前端web ui，到控制层，逻辑层，数据库访问，数据库都完全是独立的一套。</p>
<p>如果一句话来谈SOA和微服务的区别，即微服务不再强调传统SOA架构里面比较重的ESB企业服务总线，同时SOA的思想进入到单个业务系统内部实现真正的组件化。</p>
<h4 id="微服务架构中的进程间通信"><a href="#微服务架构中的进程间通信" class="headerlink" title="微服务架构中的进程间通信"></a>微服务架构中的进程间通信</h4><p>基于微服务的分布式应用是运行在多台机器上的；一般来说，每个服务实例都是一个进程。因此，如下图所示，服务之间的交互必须通过进程间通信（IPC）来实现。</p>
<p>对于微服务架构的交互模式，文章从两个维度进行了描述，即<br>一对一：每个客户端请求有一个服务实例来响应。<br>一对多：每个客户端请求有多个服务实例来响应。<br>同步模式：客户端请求需要服务端即时响应，甚至可能由于等待而阻塞。<br>异步模式：客户端请求不会阻塞进程，服务端的响应可以是非即时的。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/21/Thread/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="harry,qiyazhong@163.com">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/lufei1.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Nothing lasts forever.">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/21/Thread/" itemprop="url">线程(Thread)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-21T08:22:55+08:00">
                2017-06-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">Java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="/images/thread/state.png" alt="java Thread status"></p>
<h4 id="java-thread的运行周期中-有几种状态-在-java-lang-Thread-State-中有详细定义和说明"><a href="#java-thread的运行周期中-有几种状态-在-java-lang-Thread-State-中有详细定义和说明" class="headerlink" title="java thread的运行周期中, 有几种状态, 在 java.lang.Thread.State 中有详细定义和说明"></a>java thread的运行周期中, 有几种状态, 在 java.lang.Thread.State 中有详细定义和说明</h4><ul>
<li>NEW</li>
<li>RUNNABLE</li>
<li>BLOCKED</li>
<li>WAITING</li>
<li>TIMED_WAITING</li>
<li>TERMINATED</li>
</ul>
<hr>
<p><img src="/images/thread/FTHOR.png" alt="java Thread status"></p>
<h4 id="线程状态转换"><a href="#线程状态转换" class="headerlink" title="线程状态转换"></a>线程状态转换</h4>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/lufei1.gif"
               alt="harry,qiyazhong@163.com" />
          <p class="site-author-name" itemprop="name">harry,qiyazhong@163.com</p>
           
              <p class="site-description motion-element" itemprop="description">Every man is his own worst enemy.</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/your-user-name" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/your-user-name" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/your-user-name" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://douban.com/people/your-user-name" target="_blank" title="douban">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  douban
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.zhihu.com/people/your-user-name" target="_blank" title="zhihu">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  zhihu
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">harry,qiyazhong@163.com</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  





  






  





  

  

  

  

  

  

</body>
</html>
